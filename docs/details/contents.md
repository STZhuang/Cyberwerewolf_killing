下面给出一套**可拆分协作**的细节文档目录（含说明与交付标准），并先给出 **3 篇完整细节文档 v1**（可直接入库）。后续按编号继续扩写即可。

---

# 赛博狼人杀 · 细节文档目录（v0 规划）

| 编号      | 文档名                 | 目标与范围（一句话）                                         | 主要读者     | 交付标准               |
| ------- | ------------------- | -------------------------------------------------- | -------- | ------------------ |
| **D01** | LLM 服务提供商与模型选择规范    | 支持多提供商（base\_url+api\_key+model\_id），可热切换与按房间/席位覆盖 | 后端/Agent | API+Schema+权限+审计   |
| **D02** | 聊天气泡与时间线 UI 规范      | 发言/工具调用/投票/系统事件的统一渲染与流式更新                          | 前端/UI    | 组件 API + 状态机 + 无障碍 |
| **D03** | Agent 可见信息隔离与工具 API | 严格的可见上下文裁剪与合法动作工具接口                                | 后端/Agent | 工具契约+错误码+审计        |
| D04     | 事件溯源与可重放规范          | 事件链结构、哈希校验、幂等与回放游标                                 | 后端       | 表/索引+回放接口          |
| D05     | 房间匹配与座位分配           | 建房/入房/座位/观战与开局前校验                                  | 后端/前端    | REST/WS 流程+边界用例    |
| D06     | 阶段计时与超时策略           | Day/Night/Vote/Trial 定时器与超时默认动作                    | 后端       | 计时事件+恢复机制          |
| D07     | 身份与角色结算引擎           | 预言家/女巫/守卫/狼人/猎人等夜间/昼间结算顺序                          | 后端       | 规则表+单测边界           |
| D08     | 文本审核与反作弊            | 敏感词/侮辱过滤、频率限制、越权检测                                 | 后端       | 策略与阈值+观测指标         |
| D09     | WebSocket 协议与重连     | 事件信封、ACK、心跳、重连、丢包补偿                                | 前端/后端    | 协议文档+时序图           |
| D10     | 观战与回放 UX            | 观战权限、延迟、弹幕；回放时间轴与关键回合                              | 前端       | 组件协议+性能指标          |
| D11     | 国际化与可访问性            | i18n 资源、RTL、键盘操作、ARIA 标签                           | 前端       | a11y 清单+快照测试       |
| D12     | 负载与成本基准             | WS 广播延迟、Agent 并发、Token 成本预算                        | 全栈       | 基准脚本+仪表板           |
| D13     | 日志、审计与隐私            | 输入输出脱敏、事件留痕、追责链路                                   | 后端/运维    | 日志格式+留存策略          |
| D14     | 灰度、模型 A/B 与排行榜      | 多模型对战、胜率/合规度统计与看板                                  | 后端/数据    | 统计口径+报表结构          |
| D15     | 部署与密钥管理             | K8s/Helm、Secrets、滚动升级与回滚                           | DevOps   | 清单与演练手册            |
| D16     | 前端状态管理与虚拟滚动         | 超长聊天/事件流的渲染与内存上限                                   | 前端       | 性能准线+压测脚本          |
| D17     | 异常处理与错误码            | 全链路错误码、提示语与重试策略                                    | 全栈       | 枚举+终端文案            |
| D18     | 安全边界与渗透清单           | Auth/房间权限/注入/WS 劫持/重放攻击                            | 安全       | 检查表+修复策略           |
